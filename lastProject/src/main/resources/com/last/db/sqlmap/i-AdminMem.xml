<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL MAP 2.0//EN" 
 "http://www.ibatis.com/dtd/sql-map-2.dtd">
 
<sqlMap namespace="AdminMember">

	<typeAlias alias="str" type="java.lang.String" />
	<typeAlias alias="int" type="java.lang.Integer"/>
	<typeAlias alias="mem" type="com.last.common.vo.MemberVo"/>
	
		
	
	<select id="selectMemCount" resultClass="int">
	<![CDATA[
		SELECT COUNT(*) 
		FROM MEM
		WHERE MEM_LATELY_LOG_DATE  < SYSDATE-10
		]]>	
	</select>
	
	<select id="selectAdminMemCount" parameterClass="java.util.HashMap" resultClass="int">
		<![CDATA[
		SELECT COUNT(*) FROM MEM WHERE MEM_LATELY_LOG_DATE  < SYSDATE - 10
		<isEqual property="schType" compareValue="all">
			and 1=1
		</isEqual>
		<isEqual property="schType" compareValue="memName">
			and mem like '%'||#schText#||'%'
		</isEqual>
		<isEqual property="schType" compareValue="memId">
			and notice_content like '%'||#schText#||'%'
		</isEqual>
<!-- 		<isEqual property="schType" compareValue="adm"> -->
<!-- 			and admin_code like '%'||#schText#||'%' -->
<!-- 		</isEqual> -->
		]]>	
	</select>
	
	<select id="selectAdminMemList" parameterClass="java.util.HashMap" resultClass="mem">
		<![CDATA[
		select
		  mem_code as id,
		  mem_nm as name,
		  mem_lately_log_date
		from
			(
			  	select ROWNUM as rnum, mem_code, mem_nm, mem_lately_log_date
				  from
				    (select mem_code, mem_nm, mem_lately_log_date
				    from mem
				    where mem_lately_log_date < sysdate-10
				    order by 1 desc
				    )
			  where ROWNUM <=#endRow#
			)
		where rnum >= #firstRow#
		]]>	
	</select>
	
<!-- 	<select id="selectNoticeCode" resultClass="str"> -->
<!-- 		select notice_code from notice  -->
<!-- 	</select> -->
	
	<!-- 상세보기-->
	<select id="selectAdMemDetail" parameterClass="int" resultClass="mem">
		<![CDATA[
		select * 
		from mem 
		WHERE MEM_LATELY_LOG_DATE  < SYSDATE - 10
		and mem_code LIKE '%'||#id#||'%'
		]]>	
	</select>
	
<!-- 	<update id="updateNotice1" parameterClass="mem"> -->
<!-- 		update notice  -->
<!-- 		set  -->
<!-- 			title=#title#, -->
<!-- 			attach_file=#attach_file#,  -->
<!-- 			notice_content=#notice_content#, -->
<!-- 			enroll_date=sysdate -->
<!-- 		where notice_code=#notice_code# -->
<!-- 	</update> -->
	
<!-- 	<update id="deleteNotice1" parameterClass="str"> -->
<!-- 		delete from notice where notice_code=#notice_code# -->
<!-- 	</update> -->
	
<!-- 	<update id="insertNotice1" parameterClass="notice1"> -->
<!-- 		insert into mem(notice_code,title,notice_content,attach_file,enroll_date,regist_date,admin_code)  -->
<!-- 					values(#notice_code#,#title#,#notice_content#,#attach_file#,sysdate,sysdate,#admin_code#) -->
<!-- 	</update> -->
	
	<select id="searchAdMemList" parameterClass="java.util.HashMap" resultClass="notice1">
		<![CDATA[
		select * from mem WHERE MEM_LATELY_LOG_DATE  < SYSDATE - 10
		<isEqual property="schType" compareValue="all">
			and 1=1
		</isEqual>
		<isEqual property="schType" compareValue="title">
			and title like '%'||#schText#||'%'
		</isEqual>
		<isEqual property="schType" compareValue="content">
			and notice_content like '%'||#schText#||'%'
		</isEqual>
		<isEqual property="schType" compareValue="adm">
			and admin_code like '%'||#schText#||'%'
		</isEqual>
		]]>	
	</select>
	
</sqlMap>
